(*# MixedStateChoice #*)

(* In this protocol A tells C gossip about B, a lot of gossip, without
B knowing, but eventually B walks by and A shushes C and greets B to
dissimulate.
*)

global protocol LetMeTellYouASecret (role A, role B, role C) {
  rec X {
    choice at A {
      GOSSIP from A to C ; continue X ; (*) here B never learns this choice,
                                        (*) and it's ok because the protocol continues,
                                        (*) and maybe we don't want C to know that A and B
                                        (*) exchange M1s without telling C
    } or {
      SHHHH from A to C ; HI from A to B ;
    }
  }
}
